<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Prompt Sliders for Fine-Grained Control, Editing and Erasing of Concepts in Diffusion Models.">
  <meta name="keywords" content="Diffusion Models, Sliders and editing">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Prompt Sliders for Fine-Grained Control, Editing and Erasing of Concepts in Diffusion Models</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://deepaksridhar.github.io">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Factor Graph Diffusion: Adapting Diffusion Models for Improved Prompt Compliance and Controllable Image Synthesis</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://deepaksridhar.github.io">Deepak Sridhar</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="http://www.svcl.ucsd.edu/~nuno/">Nuno Vasconcelos</a><sup>1</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of California, San Diego</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2011.12"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper(coming soon)</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv(coming soon)</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/svcl/fgdm"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code(coming soon)</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a> -->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./static/videos/teaser.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">Nerfies</span> turns selfie videos from your phone into
        free-viewpoint
        portraits.
      </h2>
    </div>
  </div>
</section> -->


<!-- <section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/steve.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-chair-tp">
          <video poster="" id="chair-tp" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/chair-tp.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-shiba">
          <video poster="" id="shiba" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/shiba.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-fullbody">
          <video poster="" id="fullbody" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fullbody.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/blueshirt.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-mask">
          <video poster="" id="mask" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/mask.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-coffee">
          <video poster="" id="coffee" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/coffee.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-toby">
          <video poster="" id="toby" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/toby2.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section> -->


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            We present a textual inversion method for learning prompt embeddings for specific attributes/concepts using textual inversion method. 
            The strength of the concept can be controlled by manipulating the weight of the learned prompts. 
          </p>
          <p>
            Diffusion models have recently surpassed GANs in image synthesis and editing, offering superior image quality and diversity. However, achieving precise control over attributes in generated images remains a challenge. Concept Sliders introduced a method for fine-grained image control and editing by learning concepts (attributes/objects). However, this approach adds parameters and increases inference time due to the loading and unloading of Low-Rank Adapters (LoRAs) used for learning concepts. These adapters are model-specific and require retraining for different architectures, such as Stable Diffusion (SD) v1.5 and SD-XL. In this paper, we propose a straightforward textual inversion method to learn concepts through text embeddings, which are generalizable across models that share the same text encoder, including different versions of the SD model. We refer to our method as {Prompt Sliders}. Besides learning new concepts, we also show that prompt sliders can be used to erase undesirable concepts such as artistic styles or mature content. Our method is 30\% faster than using LoRAs because it eliminates the need to load and unload adapters and introduces no additional parameters aside from the target concept text embedding. Each concept embedding only requires 3KB of storage compared to the 8922 KB or more required for each LoRA adapter making our approach more computationally efficient.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Teaser. -->
    <div class="columns is-centered">
      <!-- Editing. -->
      <div class="column">
        <h2 class="title is-3">Prompt Sliders for fine-grained control of attributes with textual inversion. </h2>
            <div class="columns is-centered">
              <div class="column content">
                <p>
                  Each row in the figure shows a corresponding concept depicted on top of the image along with its control strength $\alpha$ that enhances the target concept as the guidance strength increases. The prompts for the images from top to bottom are listed as follows (in order) - {"A portrait of an woman with a warm smile", "A woman with voluminous hair cascading over her shoulders, posing for a fashion shoot", "A fantasy character", "A person caught off guard by unexpected news"
                </p>
                <embed src="./static/images/teaser-1.pdf"
                class="interpolation-image"
                type="application/pdf"
                width="100%"
                height="500px"
                alt="Image synthesis by Prompt Sliders1."/>
                <embed src="./static/images/teaser-1.pdf"
                class="interpolation-image"
                type="application/pdf"
                width="100%"
                height="500px"
                alt="Image synthesis by Prompt Sliders2."/>         
              </div>

        </div>
      </div>
    </div>

  <div class="container is-max-desktop">
    <!-- Teaser. -->
    <div class="columns is-centered">
      <!-- Editing. -->
      <div class="column">
        <h2 class="title is-3">FG-DM framework</h2>
            <div class="columns is-centered">
              <div class="column content">
                <p>
                  Left: Training of textual Prompt Sliders. Right: Training of visual Prompt
Sliders.
                </p>
                <embed src="./static/images/arch.pdf"
                class="interpolation-image"
                type="application/pdf"
                width="100%"
                height="500px"
                alt="Prompt Slider framework."/> 
              </div>

        </div>
      </div>
    </div>

  <div class="container is-max-desktop">
    <!-- Teaser. -->
    <div class="columns is-centered">
      <!-- Editing. -->
      <div class="column">
        <h2 class="title is-3">Comparison with Concept Sliders</h2>
            <div class="columns is-centered">
              <div class="column content">
                <p>
                  Unlike Concept Sliders which require careful hyperparameter tuning for learning the target concept, Prompt Sliders are simple to optimize and work well for diverse prompts. The corresponding prompts for the images in the figure from left to right are as follows. {"A whimsical dragon, full of texture and detail", "A bustling city street, with people walking", "A cat lounging comfortably on a sofa", "A child opening a gift", "A child playing with a favorite toy"}.
                </p>
                <embed src="./static/images/comparison-1.pdf"
                class="interpolation-image"
                type="application/pdf"
                width="100%"
                height="500px"
                alt="Comparison."/>
              </div>

        </div>
      </div>
    </div>

    <div class="columns is-centered">
      <!-- Editing. -->
      <div class="column">
        <h2 class="title is-3">Erasing concepts with Prompt Sliders. </h2>
        <div class="columns is-centered">
          <div class="column content">
            <p>
              Erasing concepts from pretrained diffusion models using Prompt Sliders. The prompts used to generate the image are shown on top of each image.
            </p>            
            <embed src="./static/images/erasing-1.pdf"
                class="interpolation-image"
                type="application/pdf"
                width="100%"
                height="500px"
                alt="Erasing."/>
          </div>

        </div>
      </div>
    </div>
    <!--/ Matting. -->

    <div class="columns is-centered">
      <!-- Editing. -->
      <div class="column">
        <h2 class="title is-3">Transferring the trained prompt sliders from SD-XL to SD v1.5 model. </h2>
        <div class="columns is-centered">
          <div class="column content">
            <p>
              The corresponding prompts for the images in the figure from left to right in the top row, and from left to right in the bottom row are as follows. {"A photo of a person", "A man with a thick, beard, giving a charming smile", "A bride getting ready for her wedding day", "A cozy living room"}.
            </p>
            <embed src="./static/images/sd-15-transfer.pdf"
                class="interpolation-image"
                type="application/pdf"
                width="100%"
                height="500px"
                alt="Transfer SD15."/>
            
          </div>

        </div>
      </div>
    </div>
    <!--/ Matting. -->

    <div class="columns is-centered">
      <!-- Editing. -->
      <div class="column">
        <h2 class="title is-3">Composition of multiple concepts. </h2>
        <div class="columns is-centered">
          <div class="column content">
            <p>
              The input prompt for all the images are "A photo of a person" followed by the concept tokens. Concepts are appended to the prompt sequentially and is depicted in the figure from left to right in the top row, then continues from left to right in the bottom row.
            </p>
            <embed src="./static/images/composition-1.pdf"
                class="interpolation-image"
                type="application/pdf"
                width="100%"
                height="500px"
                alt="Transfer SD15."/>
          </div>

        </div>
      </div>
    </div>
    <!--/ editing. -->

          
  </div>
</section>


<!-- <section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{deepak2023fgdm
      author    = {Sridhar, Deepak and Peri, Abhishek and Rachala, Rohith Reddy and Vasconcelos, Nuno},
      title     = {Factor Graph Diffusion Models for high fidelity, consistent and controllable image synthesis},
      journal   = {arxiV},
      year      = {2023},
    }</code></pre>
  </div>
</section> -->


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <!-- <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a> -->
      <a class="icon-link" href="https://github.com/DeepakSridhar" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website template is borrowed from <a href="https://github.com/nerfies/nerfies.github.io">nerfies
                                          </a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
